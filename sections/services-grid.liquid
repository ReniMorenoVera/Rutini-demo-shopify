{{ 'section-services-grid.css' | asset_url | stylesheet_tag }}

<div class="services-grid page-width">
  <div class="services-grid__container">
    {%- for block in section.blocks -%}
      {%- assign img = block.settings.image -%}
      {%- assign img_mobile = block.settings.image_mobile | default: block.settings.image -%}

      <div class="services-grid__item" {{ block.shopify_attributes }}>
        {%- if block.settings.link != blank -%}<a href="{{ block.settings.link }}" class="services-grid__link">{%- endif -%}
          <figure class="services-grid__media">
            {%- if img != blank -%}
              <picture>
                {%- if img_mobile != blank -%}
                  <source media="(max-width: 749px)" srcset="{{ img_mobile | image_url: width: 1100 }}">
                {%- endif -%}
                <img class="services-grid__image"
                     src="{{ img | image_url: width: 2200 }}"
                     alt="{{ block.settings.alt | escape | default: block.settings.title }}"
                     loading="lazy">
              </picture>
            {%- else -%}
              <div class="services-grid__placeholder" style="background-color: {{ block.settings.background_color }};"></div>
            {%- endif -%}

            {%- if block.settings.show_title or block.settings.cta_text != blank -%}
              <figcaption class="services-grid__caption services-grid__caption--{{ block.settings.caption_align }}">
                {%- if block.settings.show_title and block.settings.title != blank -%}
                  <h3 class="services-grid__title">{{ block.settings.title }}</h3>
                {%- endif -%}
                {%- if block.settings.cta_text != blank -%}
                  <span class="services-grid__cta">{{ block.settings.cta_text }}</span>
                {%- endif -%}
              </figcaption>
            {%- endif -%}
          </figure>
        {%- if block.settings.link != blank -%}</a>{%- endif -%}
      </div>
    {%- endfor -%}
  </div>
</div>

{% schema %}
{
  "name": "Services Grid",
  "max_blocks": 4,
  "blocks": [
    {
      "type": "service",
      "name": "Item",
      "settings": [
        { "type": "text", "id": "title", "label": "Title" },
        { "type": "image_picker", "id": "image", "label": "Desktop image" },
        { "type": "image_picker", "id": "image_mobile", "label": "Mobile image (optional)" },
        { "type": "text", "id": "alt", "label": "Alt text", "default": "" },
        { "type": "url", "id": "link", "label": "Link" },
        { "type": "checkbox", "id": "show_title", "label": "Show title overlay", "default": false },
        { "type": "text", "id": "cta_text", "label": "CTA text (optional)", "default": "" },
        { "type": "select", "id": "caption_align", "label": "Caption alignment", "default": "left",
          "options": [
            { "value": "left", "label": "Left" },
            { "value": "center", "label": "Center" },
            { "value": "right", "label": "Right" }
          ]
        },
        { "type": "color", "id": "background_color", "label": "Fallback background", "default": "#D2D2C7" }
      ]
    }
  ],
  "presets": [
    { "name": "Services Grid", "blocks": [ { "type": "service" }, { "type": "service" }, { "type": "service" } ] }
  ]
}
{% endschema %}
