
{%- if section.settings.color_bg != 'rgba(0,0,0,0)' -%}
	{%- capture bgColor -%}
		background-color: {{ section.settings.color_bg }};
	{%- endcapture -%}
{%- endif -%}
{%- if section.settings.padding_block != blank -%}
	{%- capture paddingblock -%}
		padding: {{section.settings.padding_block}};
	{%- endcapture -%}
{%- endif -%}
{%- if section.settings.margin_block != blank -%}
	{%- capture marginblock -%}
		margin: {{section.settings.margin_block}};
	{%- endcapture -%}
{%- endif -%}

{% assign product_type = product.type %}

{% assign matching_collections = "" %}
{% for collection in collections %}
  {% if collection.title contains product_type %}
    {% assign matching_collections = collection.handle %}
    {% break %}
  {% endif %}
{% endfor %}

{% if matching_collections != "" %}
  {% assign recommended_products = collections[matching_collections].products %}
{% else %}
  {% assign recommended_products = collections.all.products %}
{% endif %}

{% if recommended_products.size > 0 %}
  <div class="product-recommendations__inner">
    <div class="container{% if section.settings.full_width %}-fluid{% endif %}">
      {%- if section.settings.heading != blank -%}
        <div class="heading-group">
          <h3 class="heading">
            <span>{{ section.settings.heading }}</span>
          </h3>
          {%- if section.settings.sub_heading != blank -%}
            <div class="sub-heading">
              {{ section.settings.sub_heading }}
            </div>
          {%- endif -%}
        </div>
      {%- endif -%}
      <div class="product-recommendations__content">
        <div class="row gx-3 gx-sm-4">
          {% assign product_count = 0 %}
          {% assign limit = 4 %}
          {%- for recommended_product in recommended_products -%}
            {% if recommended_product.id != product.id %}
              <div class="col-6 col-md-3">
                {% include 'product-grid-item', product: recommended_product %}
              </div>
              {% assign product_count = product_count | plus: 1 %}
            {% endif %}
            {% if product_count >= limit %}
              {% break %}
            {% endif %}
          {%- endfor -%}
        </div>
      </div>
    </div>
  </div>
{% else %}
  <p>No se encontraron productos recomendados.</p>
{% endif %}



{% comment %} {% assign current_collection = product.collections.first %}
{% if current_collection %}
  <div class="product-recommendations__inner">
    <div class="container{% if section.settings.full_width %}-fluid{% endif %}">
      {%- if section.settings.heading != blank -%}
        <div class="heading-group">
          <h3 class="heading">
            <span>{{ section.settings.heading }}</span>
          </h3>
          {%- if section.settings.sub_heading != blank -%}
            <div class="sub-heading">
              {{ section.settings.sub_heading }}
            </div>
          {%- endif -%}
        </div>
      {%- endif -%}
      <div class="product-recommendations__content">
        <div class="row gx-3 gx-sm-4">
          {% assign product_count = 0 %}
          {% assign limit = 4 %}
          {%- for recommended_product in current_collection.products -%}
            {% if recommended_product.id != product.id %}
              <div class="col-6 col-md-3">
                {% include 'product-grid-item', product: recommended_product %}
              </div>
              {% assign product_count = product_count | plus: 1 %}
            {% endif %}
            {% if product_count >= limit %}
              {% break %}
            {% endif %}
          {%- endfor -%}
        </div>
      </div>
    </div>
  </div>
{% else %}
  <p>No se encontraron productos recomendados.</p>
{% endif %} {% endcomment %}
	
{% schema %}
{
  "name": "Product recommendations",
  "settings": [
	{
		"type": "header",
		"content": "Design Section"
	},
	{
		"type": "checkbox",
		"id": "full_with",
		"label": "Enabel Full Width?"
	},
	{
		"type": "color",
		"id": "color_bg",
		"label": "Background Color",
		"default": "rgba(0,0,0,0)"
	},
	{
		"type": "text",
		"id": "padding_block",
		"label": "Padding",
		"placeholder": "0px 0px"
	},
	{
		"type": "text",
		"id": "margin_block",
		"label": "Margin",
		"placeholder": "0px 0px"
	},
	{
		"type": "header",
		"content": "General Settings"
	},
	{
		"type": "text",
		"id": "heading",
		"label": "Heading",
		"default": "Heading"
	},
	{
		"type": "text",
		"id": "sub_heading",
		"label": "sub Heading",
		"default": "sub heading"
	}
  ]
}
{% endschema %}
